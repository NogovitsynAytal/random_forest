# RandomForest собственной выдержки.

## О проекте
RandomForest — это простая реализация алгоритма случайного леса на Python. Библиотека предназначена для задач классификации и может быть легко интегрирована в ваши проекты.

## Установка
Библиотеку можно установить через pip:
```bash
pip install git+https://github.com/NogovitsynAytal/random_forest.git
```

Также Вы можете клонировать репозиторий и установить пакет локально:
```bash
git clone https://github.com/NogovitsynAytal/random_forest.git
cd RandomForest
pip install .
```

## Использование

После установки библиотеки Вы можете импортировать её компоненты следующим образом:
```bash
from random_forest import RandomForest, train_test_split, accuracy
```

### Пример
Ниже представлен пример использования библиотеки для классификации имён по полу:
```python
from random_forest.forest import RandomForest
from random_forest.utils import train_test_split
from random_forest.metrics import accuracy
import numpy as np


def preprocess_names(names: list) -> np.ndarray:
    """
    Преобразование имен в числовые признаки.
    :param names: Список имен.
    :return: Массив признаков.
    """
    vowels = set("аеёиоуыэюя")
    features = []

    for name in names:
        name = name.lower()
        length = len(name)
        vowel_count = sum(1 for char in name if char in vowels)
        consonant_count = len(name) - vowel_count
        first_char_code = ord(name[0])

        features.append([length, vowel_count, consonant_count, first_char_code])

    return np.array(features)


# Список имен
names = [
    "Александр", "Екатерина", "Дмитрий", "Мария", "Сергей", "Анна", "Михаил", "Ольга", "Алексей", "Наталья",
    "Владимир", "Ирина", "Андрей", "Татьяна", "Василий", "Светлана", "Николай", "Юлия", "Артём", "Дарья",
    "Константин", "Елена", "Роман", "Анастасия", "Денис", "Виктория", "Тимур", "Полина", "Станислав", "Кристина",
    "Игорь", "Людмила", "Ярослав", "Надежда", "Борис", "Валентина", "Владислав", "Маргарита", "Павел", "Алёна",
    "Евгений", "Диана", "Григорий", "Вера", "Арсений", "Олеся", "Фёдор", "Зоя", "Валерий", "Вероника",
    "Роман", "Светлана", "Георгий", "Нина", "Виктор", "Галина", "Станислав", "Инна", "Николай", "Екатерина",
    "Артём", "Анастасия", "Ренат", "София", "Максим", "Дарья", "Филипп", "Юлия", "Семён", "Оксана",
    "Илья", "Алина", "Нестор", "Лилия", "Кирилл", "Милена", "Леонид", "Светла", "Валентин", "Лариса",
    "Даниил", "Марина", "Викентий", "Вероника", "Всеволод", "Яна", "Степан", "Ярослава", "Анатолий", "Татьяна",
    "Павел", "Людмила", "Вадим", "Галина", "Олег", "Полина", "Никита", "Нина", "Ярослав", "Ксения",
    "Станислав", "Мира", "Тимофей", "Дина", "Эдуард", "Ася", "Игорь", "Майя", "Илья", "Яна",
    "Борис", "Елена", "Виктор", "Ника", "Станислав", "Кира", "Григорий", "Аринэ", "Анатолий", "Лилия",
    "Виталий", "Злата", "Владислав", "Эмилия", "Денис", "Тина", "Михаил", "Арина", "Сергей", "Анастасия",
    "Николай", "Юлия", "Артём", "Татьяна", "Анатолий", "Ольга", "Олег", "Наталья", "Александр", "Валерия",
    "Роман", "Владислава", "Даниил", "Алина", "Кирилл", "Кристина", "Дмитрий", "Регина", "Евгений", "Полина"
]


# Разметка данных (0 - мужское имя, 1 - женское имя)
labels = [
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
]

# Преобразование имен в числовые признаки
X = preprocess_names(names)
y = np.array(labels)

# Разделение данных на обучающую и тестовую выборки
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Создание и обучение модели
model = RandomForest(n_trees=10, max_depth=5)
model.fit(X_train, y_train)

# Предсказание и оценка качества
y_pred = model.predict(X_test)
print("Accuracy:", accuracy(y_test, y_pred))

# Тестирование на новых именах
new_names = ["Айтал", "Наташа", "Владислав", "Степанида", "Валерий", "Евгения"]
new_X = preprocess_names(new_names)
predictions = model.predict(new_X)

for name, prediction in zip(new_names, predictions):
    gender = "Женское" if prediction == 1 else "Мужское"
    print(f"{name}: {gender}")
```

## Документация
### RandomForest

Класс для создания и обучения случайного леса.

#### Параметры:
- **n_trees (int)**: Количество деревьев в лесу.
- **max_depth (int)**: Максимальная глубина каждого дерева.
- **min_samples_split (int)**: Минимальное количество образцов для разделения узла.

#### Методы:
- **fit(X, y)**: Обучение модели на данных X и метках y.
- **predict(X)**: Предсказание меток для новых данных X.

### train_test_split

Функция для разделения данных на обучающую и тестовую выборки.

#### Параметры:
- **X (numpy.ndarray)**: Признаки.
- **y (numpy.ndarray)**: Метки.
- **test_size (float)**: Доля тестовой выборки (например, 0.2 для 20%).
- **random_state (int)**: Зерно для воспроизводимости.

### Возвращает:
- **X_train, X_test, y_train, y_test**: Разделённые данные.

## accuracy

Функция для расчёта точности предсказаний.

### Параметры:
- **y_true (numpy.ndarray)**: Истинные метки.
- **y_pred (numpy.ndarray)**: Предсказанные метки.

### Возвращает:
- **float**: Точность (от 0 до 1).

## Лицензия

Этот проект распространяется под лицензией MIT License. Вы можете свободно использовать, изменять и распространять этот код.

## Автор

Ноговицын Айтал
GitHub: [https://github.com/NogovitsynAytal](https://github.com/NogovitsynAytal)
